pipeline{
    agent none
parameters {
  choice choices: ['BUILD', 'Test', 'Deploy', 'test', 'DEPLOY'], name: 'enter the stage ?? '
}

    stages {
                stage ('BUILD') {
                     when { 
                expression{ params.STAGE_NAME == "BUILD" }
            }    
            agent { label 'masterkeynode' }

            steps{
                sh "echo Hi "
            }
        }
        
        stage ('Test') {
            parallel{
                stage ('Deploy'){
                     when { 
                expression{ params.STAGE_NAME == "Deploy" }
            }    
                agent { label 'masterkeynode' }
                   steps{
                    sh "pwd"
                }
                }
                stage ('test'){
                     when { 
                expression{ params.STAGE_NAME == "test" }
            }    
                agent { label 'masterkeynode' }

                    steps{
                        sh "echo hi"
                    }
                }
            }
        }
        
        
        stage ('DEPLOY') {
            agent { label 'node1-cproject' }
             when { 
                expression{ params.STAGE_NAME == "DEPLOY" }
            }    

            steps{
                sh "echo Hi "
            }
        }

        
    }
 }
